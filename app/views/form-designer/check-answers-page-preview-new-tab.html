{% extends "layout-govuk-form-preview.html" %}
{% set mainClasses = "main--draft govuk-main-wrapper--auto-spacing" %}

{% block pageTitle %}
  {{data['checkAnswersTitle']}} - Preview - GOV.UK
{% endblock %}

{% block beforeContent %}
  <a class="govuk-back-link" href="page-preview-new-tab/{{data['highestPageId']}}">Back</a>
{% endblock %}

{% block content %}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">


  <h1 class="govuk-panel__title">{{data['checkAnswersTitle']}} <span class="govuk-visually-hidden">preview</span></h1>

  <dl class="govuk-summary-list">
    {% for page in data.pages -%}

      {% set questionTitle = page["long-title"] or "Page " + page["pageIndex"] %}
      {% if page['questionOptional'] %}
      {% set questionTitle = questionTitle + ' (optional)' %}
      {% endif %}

      {% if questionTitle %}

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <!--Q{{page["pageIndex"] | int + 1}}.--> {{questionTitle}}
        </dt>
        <dd class="govuk-summary-list__value">
          {% if (data[loop.index]) or (data[loop.index + '-year']) or (data[loop.index + '-address-street-address']) or (data[loop.index + '-address-line-1']) or (data[loop.index + '-address-postcode']) or (data[loop.index + '-full-name']) or (data[loop.index + '-first-name']) %}
            {% if page['type'] == 'personName' %}
              {% if (page['title'] === 'yes') and (data[loop.index + '-name-title']) %}{{data[loop.index + '-name-title']}}{% endif %}
              {% if page['input'] === 'single-field' %}
                {{data[loop.index + '-full-name']}}
              {% else %}
                {{data[loop.index + '-first-name']}}
                {% if data[loop.index + '-middle-names'] %}{{data[loop.index + '-middle-names']}}{% endif %}
                {{data[loop.index + '-last-name']}}
              {% endif %}
            {% elif page['type'] == 'date' -%}
              {% if (data[loop.index + '-day']) %}{{data[loop.index + '-day']}}/{% endif %}{% if (data[loop.index + '-month']) %}{{data[loop.index + '-month']}}{% if (data[loop.index + '-year']) %}/{% endif %}{% endif %}{% if (data[loop.index + '-year']) %}{{data[loop.index + '-year']}}{% endif %}
            {%- elif page['type'] == 'address' %}
              {% if ('uk-address' in page['input']) and not ('international-address' in page['input']) %}
                {{data[loop.index + '-address-line-1']}}<br>
                {% if data[loop.index + '-address-line-2'] %}{{data[loop.index + '-address-line-2']}}<br>{% endif %}
                {{data[loop.index + '-address-town']}}<br>
                {{data[loop.index + '-address-postcode']}}
              {% else %}
                {{data[loop.index + '-address-street-address'] | replace(",","") | replace(".","") | nl2br | safe}}<br>
                {% if data[loop.index + '-address-country-name'] %}{{data[loop.index + '-address-country-name']}}{% endif %}
              {% endif %}
            {% elif page['type'] == 'select' and not page['oneOption'] %}
              {{data[loop.index]|join(", ") if data[loop.index]}}
            {% else %}
              {{data[loop.index]}}
            {% endif %}
          {% else %}
            Not completed
          {% endif %}
        </dd>
          <dd class="govuk-summary-list__actions">
              <a class="govuk-link govuk-link--no-visited-state" href="page-preview-new-tab/{{loop.index}}">
                Change <span class="govuk-visually-hidden">{{questionTitle}}<span>
              </a>
          </dd>
      </div>
      {% endif %}

    {%- endfor %}

  </dl>

    {% if data['checkAnswersDeclaration'] %}
    <h2 class="govuk-heading-m">Declaration</h2>

    <div class="app-prose-scope">
    {% markdown %}
      {{ data['checkAnswersDeclaration'] }}
    {% endmarkdown %}
    </div>

    {% endif %}

    {% if data['checkAnswersDeclaration'] %}
      {% set buttonText = 'Agree and submit' %}
    {% else %}
      {% set buttonText = 'Submit' %}
    {% endif %}
    {{ govukButton({
      text: buttonText,
      href: "confirmation-page-preview-new-tab",
      attributes: {
        target: "_parent"
      }
    }) }}
  </div>
</div>
{% endblock %}
