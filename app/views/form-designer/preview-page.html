{% extends "layout-govuk-forms.html" %}

{% set pageTitle -%} 
  {% if pageData['long-title'] %}
    {{pageData['long-title']}} 
  {% else %} 
    Edit question 
  {% endif %}
{%- endset %} 

{% block pageTitle %}
  {{pageTitle|safe}} - GOV.UK Forms
{% endblock %}
{% block beforeContent %}
  <a class="govuk-back-link" href="../edit-page/{{pageId}}">Back</a> 
{% endblock %} 

{% block content %}

<form id="form" class="form" action="../edit-page/{{pageId}}" method="post">
  <div class="govuk-grid-row">
    <h2 class="govuk-heading-m govuk-grid-column-two-thirds">Question preview</h2>
    <a
      href="../page-preview-new-tab/{{pageId}}"
      class="govuk-link govuk-link--no-visited-state govuk-!-margin-bottom-4 new-tab-link govuk-grid-column-one-third"
      target="_blank"
      style="text-align: right"
      >Preview question in a new tab</a
    >
  </div>
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
      {% set namePrefix = "pages[" + pageIndex + "]" %}
      <div class="preview-pane-wrapper">
        
        <div class="preview-header">
          <p class="preview-link govuk-body-s">
            <!-- <a href="#" target="_blank" onclick="document.getElementById('form').submit();">Refresh</a> &nbsp;|&nbsp; -->
          </p>
        </div>
        <iframe
          sandbox="allow-same-origin allow-scripts"
          title="Page preview"
          data-module="app-example-frame"
          class="preview-pane app-example__frame app-example__frame--resizable"
          src="../../page-preview/{{pageId}}"
          frameborder="1"
          loading="lazy"
          id="iFrameResizer0"
        ></iframe>
      </div>

      <input
        type="hidden"
        id="index"
        name="{{namePrefix}}[pageIndex]'"
        value="{{[pageIndex]}}"
      />

      <div class="govuk-button-group">
        {% if pageId >= data['highestPageId'] %} {{ govukButton({ text: "Create
        next question", classes: "govuk-button", name: "action", value:
        "createNextPage" }) }} {% else %} {{ govukButton({ text: "Edit next
        question", classes: "govuk-button", name: "action", value:
        "editNextPage" }) }} {% endif %}

        <p class="govuk-body">
          or
          <a
            class="govuk-link govuk-link--no-visited-state"
            href="../form-index"
            >go to form overview</a
          >
        </p>
      </div>
    </div>
  </div>
</form>

{% endblock %}
